{"remainingRequest":"/home/david/practable/spinner-amax/ui/node_modules/babel-loader/lib/index.js!/home/david/practable/spinner-amax/ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/david/practable/spinner-amax/ui/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/david/practable/spinner-amax/ui/src/components/StepCommand.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/david/practable/spinner-amax/ui/src/components/StepCommand.vue","mtime":1661865032538},{"path":"/home/david/practable/spinner-amax/ui/babel.config.js","mtime":1653472124337},{"path":"/home/david/practable/spinner-amax/ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/david/practable/spinner-amax/ui/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/david/practable/spinner-amax/ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/david/practable/spinner-amax/ui/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvZGF2aWQvcHJhY3RhYmxlL3NwaW5uZXItYW1heC91aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdGVwQ29tbWFuZCcsCiAgcHJvcHM6IHsKICAgIG1vZGU6IFN0cmluZwogIH0sCiAgZW1pdHM6IFsnc2hvd2lucHV0dHlwZSddLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzdGVwX3NpemU6IDAuMDAsCiAgICAgIG1heF9wb3NpdGlvbl9zdGVwOiA2LAogICAgICBtYXhfc3BlZWRfc3RlcDogMTAwLAogICAgICBtYXhfdm9sdGFnZV9zdGVwOiAxMCwKICAgICAgaXNTdGVwUnVubmluZzogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIHZlcnNpb24gPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFJlbW90ZUxhYlZlcnNpb247CgogICAgaWYgKHZlcnNpb24gPT0gJ3ZhcmlhYmxlX2dvdmVybm9yJykgewogICAgICB0aGlzLm1heF9wb3NpdGlvbl9zdGVwID0gTWF0aC5QSTsgLy92YXJpYWJsZSBnb3Zlcm5vciBjYW4gc3BpbiBmdWxsIGNpcmNsZQogICAgfSBlbHNlIGlmICh2ZXJzaW9uID09ICdyb2JvdF9hcm0nKSB7CiAgICAgIHRoaXMubWF4X3Bvc2l0aW9uX3N0ZXAgPSAzICogTWF0aC5QSSAvIDEwOyAvL3JvYm90IGFybSBpcyBzb2Z0IGxpbWl0ZWQgdG8gMzAwIGVuY29kZXIgc3RlcHMgZnJvbSAwLgogICAgfQogIH0sCiAgbWV0aG9kczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBBY3Rpb25zKFsnc2V0RHJhZ2dhYmxlJ10pKSwge30sIHsKICAgIHJ1blN0ZXA6IGZ1bmN0aW9uIHJ1blN0ZXAoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldElzRGF0YVJlY29yZGVyT24pIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2V0SXNSZWNvcmRpbmcnLCB0cnVlKTsKICAgICAgfQoKICAgICAgdGhpcy4kZW1pdCgnc2hvd2lucHV0dHlwZScsIGZhbHNlKTsgLy8gIGxldCBzdGVwID0gewogICAgICAvLyAgICAgIHN0ZXBfdGltZTogdGhpcy50aW1lX3RvX3N0ZXAsCiAgICAgIC8vICAgICAgc3RlcF9zdGFydDogMCwKICAgICAgLy8gICAgICBzdGVwX3NpemU6IHRoaXMuc3RlcF9zaXplCiAgICAgIC8vICB9CiAgICAgIC8vICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2V0U3RlcCcsIHN0ZXApOwoKICAgICAgdGhpcy5zZW5kQ29tbWFuZCgpOwogICAgfSwKICAgIHNlbmRDb21tYW5kOiBmdW5jdGlvbiBzZW5kQ29tbWFuZCgpIHsKICAgICAgaWYgKHRoaXMubW9kZSA9PSAnc3BlZWRSYXcnKSB7CiAgICAgICAgdGhpcy5pc1N0ZXBSdW5uaW5nID0gdHJ1ZTsKICAgICAgICB2YXIgc2lnbmFsID0gcGFyc2VGbG9hdCh0aGlzLnN0ZXBfc2l6ZSk7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NldFZvbHRhZ2UnLCBzaWduYWwpOwogICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PSAncG9zaXRpb25QaWQnKSB7CiAgICAgICAgdGhpcy5pc1N0ZXBSdW5uaW5nID0gdHJ1ZTsgLy9ORVcgISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhCgogICAgICAgIHZhciBuZXdfYW5nX3JhZCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q3VycmVudEFuZ2xlICsgcGFyc2VGbG9hdCh0aGlzLnN0ZXBfc2l6ZSk7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NldFBvc2l0aW9uJywgbmV3X2FuZ19yYWQpOwogICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PSAnc3BlZWRQaWQnKSB7CiAgICAgICAgdGhpcy5pc1N0ZXBSdW5uaW5nID0gdHJ1ZTsKICAgICAgICB2YXIgcmFkX3MgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEN1cnJlbnRBbmd1bGFyVmVsb2NpdHkgKyBwYXJzZUZsb2F0KHRoaXMuc3RlcF9zaXplKTsgLy9uZWVkcyB0byBiZSBpbiByYWQvcwoKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2V0U3BlZWQnLCByYWRfcyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdhZGRNdWx0aXBsZUFjaGlldmVtZW50JywgJ211bHRpcGxlLXJ1bnMnKTsKICAgIH0sCiAgICBzdG9wU3RlcDogZnVuY3Rpb24gc3RvcFN0ZXAoKSB7CiAgICAgIC8vdGhpcyBpcyBhbiBpbnRlcm5hbCBtb2RlIGluIHRoZSBmaXJtd2FyZSBhbmQgZG9lcyBub3QgbmVlZCB0byBiZSByZWZsZWN0ZWQgaW4gdGhlIFVJLgogICAgICB0aGlzLmlzU3RlcFJ1bm5pbmcgPSBmYWxzZTsgLy9ORVcgISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEKCiAgICAgIHRoaXMuJGVtaXQoJ3Nob3dpbnB1dHR5cGUnLCB0cnVlKTsKCiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldElzUmVjb3JkaW5nKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NldElzUmVjb3JkaW5nJywgZmFsc2UpOwogICAgICB9CgogICAgICBpZiAodGhpcy5tb2RlID09ICdwb3NpdGlvblBpZCcpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnd2FpdCcpOwogICAgICB9IGVsc2UgaWYgKHRoaXMubW9kZSA9PSAnc3BlZWRSYXcnKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NldFZvbHRhZ2UnLCAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnd2FpdCcpOwogICAgICB9CiAgICB9CiAgfSkKfTs="},{"version":3,"sources":["/home/david/practable/spinner-amax/ui/src/components/StepCommand.vue"],"names":[],"mappings":"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","sourcesContent":["//vue3 update\n\n<template>\n        \n        <div class=\"row d-flex justify-content-center m-4\" @mousedown=\"setDraggable(false)\" @mouseup=\"setDraggable(true)\">  \n            <div class='col-auto'>\n                <div class='input-group' v-if='mode == \"speedRaw\"'>\n                    <span class='input-group-text' for=\"step_raw\">Step size ({{-max_voltage_step}} to {{max_voltage_step}}V)</span>\n                    <input type=\"number\" :max='max_voltage_step' :min='-max_voltage_step' :class=\"(parseFloat(step_size) >= -max_voltage_step && parseFloat(step_size) <= max_voltage_step) ? 'form-control' : 'form-control is-invalid'\" id=\"step_raw\" v-model=\"step_size\">\n                    <button class='btn btn-lg' id=\"run\" @click=\"runStep(); this.$store.dispatch('setAchievementCompleted', 'speedRaw-step-input')\">Run</button>\n                    <button class='btn btn-lg btn-danger' v-if='isStepRunning' id=\"wait\" @click=\"stopStep\">Stop</button>\n                </div>\n            \n\n                <div class='input-group' v-else-if='mode == \"speedPid\"'>\n                    <span class='input-group-text' for=\"step_speed\">Step size (0 - {{max_speed_step}} rad/s)</span>\n                    <input type=\"number\" :max='max_speed_step' :min='-max_speed_step' :class=\"(parseFloat(step_size) >= -max_speed_step && parseFloat(step_size) <= max_speed_step) ? 'form-control' : 'form-control is-invalid'\" id=\"step_speed\" v-model=\"step_size\">\n                    <button class='btn btn-lg' id=\"run\" @click=\"runStep\">Run</button>\n                    <button class='btn btn-lg btn-danger' v-if='isStepRunning' id=\"wait\" @click=\"stopStep\">Stop</button>\n                </div>\n\n                <div class='input-group' v-else-if='mode == \"positionPid\"'>\n                    <span class='input-group-text' for=\"step_speed\">Step size (0 - {{max_position_step.toFixed(2)}} rad)</span>\n                    <input type=\"number\" step='0.01' :max='max_position_step.toFixed(2)' :min='-max_position_step.toFixed(2)' :class=\"(parseFloat(step_size) >= -max_position_step && parseFloat(step_size) <= max_position_step) ? 'form-control' : 'form-control is-invalid'\" id=\"step_position\" v-model=\"step_size\" >\n                    <button class='btn btn-lg' v-if='!isStepRunning' id=\"run\" @click=\"runStep(); this.$store.dispatch('checkPIDControllerConditions')\">Run</button>\n                    <button class='btn btn-lg btn-danger' v-else-if='isStepRunning' id=\"wait\" @click=\"stopStep\">Stop</button>\n                </div>\n\n            </div>\n        </div>\n       \n</template>\n\n<script>\nimport { mapActions } from 'vuex';\n\nexport default {\n\n  name: 'StepCommand',\n  props:{\n      mode: String,\n  },\n  emits:['showinputtype'],\n  data () {\n    return {\n        step_size: 0.00,            \n        max_position_step: 6, \n        max_speed_step: 100,\n        max_voltage_step: 10,\n        isStepRunning: false,\n    }\n  },\n  created(){\n      let version = this.$store.getters.getRemoteLabVersion;\n        if( version == 'variable_governor'){\n            this.max_position_step = Math.PI;             //variable governor can spin full circle\n        } else if(version == 'robot_arm'){\n            this.max_position_step = 3*Math.PI/10;          //robot arm is soft limited to 300 encoder steps from 0.\n        }\n\t},\n  methods: {\n      ...mapActions([\n          'setDraggable'\n      ]),\n     runStep(){\n         if(this.$store.getters.getIsDataRecorderOn){\n                 this.$store.dispatch('setIsRecording', true);\n             }\n\n         this.$emit('showinputtype', false);\n         \n        //  let step = {\n        //      step_time: this.time_to_step,\n        //      step_start: 0,\n        //      step_size: this.step_size\n        //  }\n        //  this.$store.dispatch('setStep', step);\n         \n        this.sendCommand();\n             \n     },\n     sendCommand(){\n         if(this.mode == 'speedRaw'){\n             \n             this.isStepRunning = true; \n             let signal = parseFloat(this.step_size);\n             this.$store.dispatch('setVoltage', signal);\n\n         } else if(this.mode == 'positionPid'){\n\n             this.isStepRunning = true;                      //NEW !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n             let new_ang_rad = this.$store.getters.getCurrentAngle + parseFloat(this.step_size);\n             this.$store.dispatch('setPosition', new_ang_rad);\n\n         } else if(this.mode == 'speedPid'){\n\n             this.isStepRunning = true; \n             let rad_s = this.$store.getters.getCurrentAngularVelocity + parseFloat(this.step_size);           //needs to be in rad/s\n             this.$store.dispatch('setSpeed', rad_s);\n\n         }\n\n         \n         this.$store.dispatch('addMultipleAchievement','multiple-runs');\n         \n     },\n     stopStep(){\n            //this is an internal mode in the firmware and does not need to be reflected in the UI.\n            this.isStepRunning = false;\t\t\t\t//NEW !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t\t\t\n            this.$emit('showinputtype', true);\n\n            if(this.$store.getters.getIsRecording){\n                 this.$store.dispatch('setIsRecording', false);\n             }\n\n            if(this.mode == 'positionPid'){\n                this.$store.dispatch('wait');\n            } else if(this.mode == 'speedRaw'){\n                this.$store.dispatch('setVoltage', 0);\n            } else {\n                this.$store.dispatch('wait');\n            }\n             \n\t\t},\n     \n  }\n}\n</script>\n\n<style scoped>\ninput{\n    min-width: 20%;\n    max-width: 50%;\n}\n.error{\n    /* border:thick solid red */\n    border: auto;\n}\n\n.error:focus{\n    /* border:thick solid red */\n    border: auto;\n}\n\n#run       {background-color:  rgb(74, 223, 37);}\n#run:hover {background-color: #0b7e0f} \n#wait       {background-color:  rgb(255, 30, 0);}\n#wait:hover {background-color: #520303} \n\n\n</style>"],"sourceRoot":""}]}